---
version: "2"
services:
  gogs:
    image: gogs/gogs:0.11
    environment:
      GOGS_CUSTOM: /app/gogs/custom
    labels:
      io.rancher.scheduler.affinity:host_label: data.gogs=true
      io.rancher.sidekicks: gogs-conf
    external_links:
      - ${GOGS_DATABASE_SERVICE}:db
    volumes:
      - gogs-data:/data
    volumes_from:
      - gogs-conf

  gogs-conf:
    image: camptocamp/gogs-conf:20160526-1
    labels:
      io.rancher.container.start_once: 'true'
    environment:
      GOGS_SERVER_DOMAIN: ${GOGS_SERVER_DOMAIN}
      GOGS_SERVER_ROOT_URL: https://${GOGS_SERVER_DOMAIN}/
      GOGS_SERVER_SSH_PORT: ${GOGS_SERVER_SSH_PORT}
      GOGS_SERVICE_ENABLE_NOTIFY_MAIL: ${GOGS_SERVICE_ENABLE_NOTIFY_MAIL}
      GOGS_SERVICE_ENABLE_REVERSE_PROXY_AUTHENTICATION: ${GOGS_SERVICE_ENABLE_REVERSE_PROXY_AUTHENTICATION}
      GOGS_SERVICE_ENABLE_REVERSE_PROXY_AUTO_REGISTRATION: ${GOGS_SERVICE_ENABLE_REVERSE_PROXY_AUTO_REGISTRATION}
      GOGS_SERVICE_DISABLE_REGISTRATION: ${GOGS_SERVICE_DISABLE_REGISTRATION}
      GOGS_SERVICE_SHOW_REGISTRATION_BUTTON: ${GOGS_SERVICE_HOW_REGISTRATION_BUTTON}
      GOGS_MAILER_ENABLED: ${GOGS_MAILER_ENABLED}
      GOGS_MAILER_FROM: ${GOGS_MAILER_FROM}
      GOGS_MAILER_HOST: ${GOGS_MAILER_HOST}
      GOGS_MAILER_USER: ${GOGS_MAILER_USER}
      GOGS_MAILER_PASSWD: ${GOGS_MAILER_PASSWD}
      GOGS_MAILER_SKIP_VERIFY: ${GOGS_MAILER_SKIP_VERIFY}
